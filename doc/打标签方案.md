### 采集点打标签方案
打标签就是给市场部采集回来的大量采集点打上我们自己定义的地理标签。如，对于一个在** 西少爷肉夹馍**店铺旁边或者里面采集的点信息，标注上我们自己定义的标签信息，如**商场 -> 餐饮 -> 中餐 -> 西北 -> 大众**。

### 定义的地理位置标签系统
现在我们定义的标签系统分为十大行业（商场，家电，综合医院等），每个行业又根据实际情况定义了采集位置（门口，店内等）。如下表所示：

| ^_^ | 1  | 2 |  3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |
|---|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
| 行业  | 商场 | 家电  | 家居建材  |综合医院|专科医院|4S店|售楼处|酒店|SPA|婚纱摄影|

比如对于商场，定义的采集点位置如下：

| ^_^ | 1  | 2 |  3 | 4 |
|---|:-:|:-:|:-:|:-:|
| 点类型  | 门口 | 路口  | 店外 | 店内 |

而对于每一个行业，我们都按照适合该行业的不同维度进行了分类，例如，对于**商场**行业，按照**品类**维度分为服装，鞋帽等，如下：

| ^_^ | 1  | 2 | 3 |4|5|6|7|8|9|10|11|
|---|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
| 品类  |服装|鞋帽|箱包|珠宝首饰|美装|餐饮|娱乐|教育|超市|保健品|瘦身纤体|

比如餐饮品类按照类别维度又分为中餐，西餐等，如下：

| ^_^ | 1  | 2 |  3 |
|---|:-:|:-:|:-:|
| 类别  |  中餐 | 西餐  | 韩国菜  |

其它9个行业的分类情况类似。上述就是我们定义的地理位置标签系统的大概情况。详情可以询问翁建创同学。

### 市场部采集回来的采集点情况
截至2016.12.06,采集点总数量为133,2372。按照行业具体如下：

| ^_^ | 医院 | 家电 | 家居建材 | 4S| 其它|
|---|:-:|:-:|:-:|:-:|:-:|
| 数量  |  182582 | 56007  | 58526  |41150|...|

采集点信息主要存储于数据库的**tbl_cp***系列表格，字段如下及数据样例如下：

** tbl_cp **

| id |ref_area_code | point_index | point_code | create_time | submit_times |
|:-:|:-:|:-:|:-:|:-:|:-:|
| 515987 | A-NMP-NJ25-USERADD-18620454648-20161017155632  |30210|CP-NMP-NJ25-USERADD-18620454648-20161017155632-30210-t5-1476788152077|2016-10-18 17:49:24.886|5|

** tbl_cp_prop **

| id  | ref_cp_code | ref_cptype_code | point_name | floor_number
|:-:|:-:|:-:|:-:|:-:|
| 1371642 | CP-NMP-BJ10-DXQ-DXQZYY964-10009-t2-1480564360923  | CP-HOSPITAL-ENTRY|医院后门|1|

** tbl_cp_exprop **

| id  | ref_cp_code | ref_exprop_code | prop_value|
|---|:-:|:-:|:-:|
| 97186 |  CP-NMP-GZ20-THQ-SNDQTHBD202-10000-t1 | EXP-CATEGORY  | 手机专区 |

### 自动打标签方法
所有的标签信息存储在**tbl_tag_definition**表格中，如下：

| id  | name |  pid |node_type|ref_tag_type_code
|:-:|:-:|:-:|:-:|:-:|
| 54008  |  神经内科 | 54003  | PROP_VALUE  | TTC_CLASS

那么对一个采集点cp，通过其tbl_cp_prop.point_name或者tbl_cp_exprop.prop_value的文字信息匹配标签的name字段，就可以知道该采集点应该标注为哪种标签。

所以医院，家电，家居建材的处理结果为：

|   | 总数  | 标注出来数目 |  未标注数目 |
|---|:-:|:-:|:-:|
| 医院  |  182582 | 138623  | 43959  |
| 家电  |  56007 |  40463 |  15544 |
| 家居  |  58526 |  44067 |  14459 |

上述每个行业都会有一部分采集点未能自动标注出来，主要是如下原因：
* point_name由采集员手动输入，所以内容会千差万别
* 有的采集点在tbl_cp_prop表格里面存在，但是tbl_cp_exprop表格中没有对应的数据，所以当point_name不能打出标签时，prop_value也不存在
* 关键词匹配方法不一定准确，因为有的采集点的文字信息point_name, prop_value并不和这个采集点所归属的行业相关。

理想状态下，如果能严格定义标签系统，即层级结构，标签名称，那么我就可以根据采集点可用的信息标注出这个采集点的标签。但实际上标签定义和采集点信息之间存在**信息差距**, 采集点的信息也不完整，所以会造成部分数据不能自动打上标签。下面是处理方法：
* 标签系统的定义尽量参照采集点的信息，即point_name,prop_value字段的实际情况
* 后续完善采集点信息
* 挖掘隐含信息，如从"奥迪A4l"推断出车系（跑车，商务车etc），通过定义新的关系对照表
* 剩下的使用运营人工标注，如可以返回市场部，从新整理。
* 在剩下的就是垃圾数据了，因为理论上每个被市场部审核通过的数据，都是一个具体的九大行业里面的地点，肯定会属于某一个行业某个标签。
